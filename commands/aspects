#!/bin/bash
# HALCON Aspects Command - Planetary Aspects
# Usage:
#   aspects [--date YYYY-MM-DD] [--orb DEGREES]
#   aspects <profile-name> [--orb DEGREES]

SCRIPT_DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"
PROJECT_DIR="$SCRIPT_DIR/../claude-sdk-microservice"

# Colors
CYAN='\033[0;36m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
RED='\033[0;31m'
NC='\033[0m'

# Show usage if help requested
if [[ "$1" == "--help" ]] || [[ "$1" == "-h" ]]; then
    echo -e "${CYAN}╔════════════════════════════════════════════╗${NC}"
    echo -e "${CYAN}║       HALCON PLANETARY ASPECTS             ║${NC}"
    echo -e "${CYAN}╚════════════════════════════════════════════╝${NC}"
    echo ""
    echo "Calculate planetary aspects (angular relationships)"
    echo ""
    echo -e "${GREEN}Profile Usage:${NC}"
    echo "  aspects <profile-name> [--orb DEGREES]"
    echo ""
    echo "Examples:"
    echo "  aspects manu"
    echo "  aspects manu --orb 6"
    echo ""
    echo -e "${GREEN}Date Usage:${NC}"
    echo "  aspects [--date YYYY-MM-DD] [--orb DEGREES]"
    echo ""
    echo "Examples:"
    echo "  aspects                    # Current aspects"
    echo "  aspects --date 2025-10-15  # Aspects for date"
    echo "  aspects --orb 6            # Custom orb tolerance"
    echo ""
    echo "Options:"
    echo "  --date, -d DATE  Date for aspects (default: today)"
    echo "  --orb DEGREES    Orb tolerance (default: 8)"
    echo "  --json           Output as JSON"
    echo ""
    echo "Aspects calculated:"
    echo "  ☌ Conjunction (0°)   - Blending energies"
    echo "  ⚹ Sextile (60°)      - Opportunity"
    echo "  □ Square (90°)       - Tension, challenge"
    echo "  △ Trine (120°)       - Harmony, flow"
    echo "  ☍ Opposition (180°)  - Polarity, awareness"
    echo ""
    exit 0
fi

# Forward to TypeScript CLI
cd "$PROJECT_DIR"
exec npx ts-node -r tsconfig-paths/register src/cli/aspects.ts "$@"
